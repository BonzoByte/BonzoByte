import{a as vt}from"./chunk-B3HH2VOI.js";import{a as G}from"./chunk-HUUYCMFX.js";import{c as Ce,e as mt,f as ee,g as pt,i as te,j,k as B}from"./chunk-FTZJADZT.js";import{b as gt,c as ht}from"./chunk-GTH4H3DD.js";import{a as D,b as C,c as V,d as R,f as A,h as U,i as O,j as x,k as ft,l as N}from"./chunk-UL5CEDMN.js";import{a as P,b as F}from"./chunk-4PILAPRA.js";import{a as Y,f as K}from"./chunk-3TN6O5IR.js";import{$ as rt,Ab as je,B as Z,Bb as Be,Cb as ge,Db as a,Eb as M,F as et,Fb as ut,G as tt,H as it,J as H,Ja as fe,Kb as he,Lb as ve,M as nt,Ma as c,Nb as be,Qb as dt,R as xe,Ra as h,U as ae,Xa as S,Ya as st,_ as q,_a as at,a as Ae,ab as v,ba as le,da as T,ec as _e,fa as ot,gc as y,hb as u,jb as E,jc as k,ka as f,la as g,ma as pe,n as L,nb as o,ob as s,p as X,pb as b,qb as lt,r as se,ra as w,rb as ct,sb as _,tb as d,ub as p,v as Ue,w as Oe,x as Ye,zb as Ne}from"./chunk-7QM3SHZA.js";var $=class{},Ge=(()=>{class i extends ${getTranslation(t){return L({})}static \u0275fac=(()=>{let t;return function(n){return(t||(t=pe(i)))(n||i)}})();static \u0275prov=q({token:i,factory:i.\u0275fac})}return i})(),ie=class{},ze=(()=>{class i{handle(t){return t.key}static \u0275fac=function(e){return new(e||i)};static \u0275prov=q({token:i,factory:i.\u0275fac})}return i})();function Se(i,r){if(i===r)return!0;if(i===null||r===null)return!1;if(i!==i&&r!==r)return!0;let t=typeof i,e=typeof r,n,l,m;if(t==e&&t=="object")if(Array.isArray(i)){if(!Array.isArray(r))return!1;if((n=i.length)==r.length){for(l=0;l<n;l++)if(!Se(i[l],r[l]))return!1;return!0}}else{if(Array.isArray(r))return!1;m=Object.create(null);for(l in i){if(!Se(i[l],r[l]))return!1;m[l]=!0}for(l in r)if(!(l in m)&&typeof r[l]<"u")return!1;return!0}return!1}function z(i){return typeof i<"u"&&i!==null}function ue(i){return we(i)&&!We(i)&&i!==null}function we(i){return typeof i=="object"}function We(i){return Array.isArray(i)}function Qe(i){return typeof i=="string"}function kt(i){return typeof i=="function"}function He(i,r){let t=Object.assign({},i);return we(i)?(we(i)&&we(r)&&Object.keys(r).forEach(e=>{ue(r[e])?e in i?t[e]=He(i[e],r[e]):Object.assign(t,{[e]:r[e]}):Object.assign(t,{[e]:r[e]})}),t):He({},r)}function qe(i,r){let t=r.split(".");r="";do r+=t.shift(),z(i)&&z(i[r])&&(ue(i[r])||We(i[r])||!t.length)?(i=i[r],r=""):t.length?r+=".":i=void 0;while(t.length);return i}function Mt(i,r,t){let e=r.split("."),n=i;for(let l=0;l<e.length;l++){let m=e[l];l===e.length-1?n[m]=t:((!n[m]||!ue(n[m]))&&(n[m]={}),n=n[m])}}var W=class{},Ke=(()=>{class i extends W{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(t,e){if(Qe(t))return this.interpolateString(t,e);if(kt(t))return this.interpolateFunction(t,e)}interpolateFunction(t,e){return t(e)}interpolateString(t,e){return e?t.replace(this.templateMatcher,(n,l)=>{let m=qe(e,l);return z(m)?m:n}):t}static \u0275fac=(()=>{let t;return function(n){return(t||(t=pe(i)))(n||i)}})();static \u0275prov=q({token:i,factory:i.\u0275fac})}return i})(),Q=class{},$e=(()=>{class i extends Q{compile(t,e){return t}compileTranslations(t,e){return t}static \u0275fac=(()=>{let t;return function(n){return(t||(t=pe(i)))(n||i)}})();static \u0275prov=q({token:i,factory:i.\u0275fac})}return i})(),ne=class{defaultLang;currentLang=this.defaultLang;translations={};langs=[];onTranslationChange=new w;onLangChange=new w;onDefaultLangChange=new w},ye=new le("ISOLATE_TRANSLATE_SERVICE"),ke=new le("USE_DEFAULT_LANG"),Me=new le("DEFAULT_LANGUAGE"),Ee=new le("USE_EXTEND"),ce=i=>X(i)?i:L(i),Le=(()=>{class i{store;currentLoader;compiler;parser;missingTranslationHandler;useDefaultLang;extend;loadingTranslations;pending=!1;_translationRequests={};lastUseLanguage=null;get onTranslationChange(){return this.store.onTranslationChange}get onLangChange(){return this.store.onLangChange}get onDefaultLangChange(){return this.store.onDefaultLangChange}get defaultLang(){return this.store.defaultLang}set defaultLang(t){this.store.defaultLang=t}get currentLang(){return this.store.currentLang}set currentLang(t){this.store.currentLang=t}get langs(){return this.store.langs}set langs(t){this.store.langs=t}get translations(){return this.store.translations}set translations(t){this.store.translations=t}constructor(t,e,n,l,m,Re=!0,I=!1,de=!1,me){this.store=t,this.currentLoader=e,this.compiler=n,this.parser=l,this.missingTranslationHandler=m,this.useDefaultLang=Re,this.extend=de,I&&(this.store=new ne),me&&this.setDefaultLang(me)}setDefaultLang(t){if(t===this.defaultLang)return;let e=this.retrieveTranslations(t);typeof e<"u"?(this.defaultLang==null&&(this.defaultLang=t),e.pipe(H(1)).subscribe(()=>{this.changeDefaultLang(t)})):this.changeDefaultLang(t)}getDefaultLang(){return this.defaultLang}use(t){if(this.lastUseLanguage=t,t===this.currentLang)return L(this.translations[t]);this.currentLang||(this.currentLang=t);let e=this.retrieveTranslations(t);return X(e)?(e.pipe(H(1)).subscribe(()=>{this.changeLang(t)}),e):(this.changeLang(t),L(this.translations[t]))}changeLang(t){t===this.lastUseLanguage&&(this.currentLang=t,this.onLangChange.emit({lang:t,translations:this.translations[t]}),this.defaultLang==null&&this.changeDefaultLang(t))}retrieveTranslations(t){if(typeof this.translations[t]>"u"||this.extend)return this._translationRequests[t]=this._translationRequests[t]||this.loadAndCompileTranslations(t),this._translationRequests[t]}getTranslation(t){return this.loadAndCompileTranslations(t)}loadAndCompileTranslations(t){this.pending=!0;let e=this.currentLoader.getTranslation(t).pipe(xe(1),H(1));return this.loadingTranslations=e.pipe(se(n=>this.compiler.compileTranslations(n,t)),xe(1),H(1)),this.loadingTranslations.subscribe({next:n=>{this.translations[t]=this.extend&&this.translations[t]?Ae(Ae({},n),this.translations[t]):n,this.updateLangs(),this.pending=!1},error:n=>{this.pending=!1}}),e}setTranslation(t,e,n=!1){let l=this.compiler.compileTranslations(e,t);(n||this.extend)&&this.translations[t]?this.translations[t]=He(this.translations[t],l):this.translations[t]=l,this.updateLangs(),this.onTranslationChange.emit({lang:t,translations:this.translations[t]})}getLangs(){return this.langs}addLangs(t){let e=t.filter(n=>!this.langs.includes(n));e.length>0&&(this.langs=[...this.langs,...e])}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResultForKey(t,e,n){let l;if(t&&(l=this.runInterpolation(qe(t,e),n)),l===void 0&&this.defaultLang!=null&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(l=this.runInterpolation(qe(this.translations[this.defaultLang],e),n)),l===void 0){let m={key:e,translateService:this};typeof n<"u"&&(m.interpolateParams=n),l=this.missingTranslationHandler.handle(m)}return l!==void 0?l:e}runInterpolation(t,e){if(We(t))return t.map(n=>this.runInterpolation(n,e));if(ue(t)){let n={};for(let l in t){let m=this.runInterpolation(t[l],e);m!==void 0&&(n[l]=m)}return n}else return this.parser.interpolate(t,e)}getParsedResult(t,e,n){if(e instanceof Array){let l={},m=!1;for(let I of e)l[I]=this.getParsedResultForKey(t,I,n),m=m||X(l[I]);if(!m)return l;let Re=e.map(I=>ce(l[I]));return Ye(Re).pipe(se(I=>{let de={};return I.forEach((me,yt)=>{de[e[yt]]=me}),de}))}return this.getParsedResultForKey(t,e,n)}get(t,e){if(!z(t)||!t.length)throw new Error('Parameter "key" is required and cannot be empty');return this.pending?this.loadingTranslations.pipe(tt(n=>ce(this.getParsedResult(n,t,e)))):ce(this.getParsedResult(this.translations[this.currentLang],t,e))}getStreamOnTranslationChange(t,e){if(!z(t)||!t.length)throw new Error('Parameter "key" is required and cannot be empty');return Ue(Oe(()=>this.get(t,e)),this.onTranslationChange.pipe(ae(n=>{let l=this.getParsedResult(n.translations,t,e);return ce(l)})))}stream(t,e){if(!z(t)||!t.length)throw new Error('Parameter "key" required');return Ue(Oe(()=>this.get(t,e)),this.onLangChange.pipe(ae(n=>{let l=this.getParsedResult(n.translations,t,e);return ce(l)})))}instant(t,e){if(!z(t)||t.length===0)throw new Error('Parameter "key" is required and cannot be empty');let n=this.getParsedResult(this.translations[this.currentLang],t,e);return X(n)?Array.isArray(t)?t.reduce((l,m)=>(l[m]=m,l),{}):t:n}set(t,e,n=this.currentLang){Mt(this.translations[n],t,Qe(e)?this.compiler.compile(e,n):this.compiler.compileTranslations(e,n)),this.updateLangs(),this.onTranslationChange.emit({lang:n,translations:this.translations[n]})}changeDefaultLang(t){this.defaultLang=t,this.onDefaultLangChange.emit({lang:t,translations:this.translations[t]})}reloadLang(t){return this.resetLang(t),this.loadAndCompileTranslations(t)}resetLang(t){delete this._translationRequests[t],delete this.translations[t]}getBrowserLang(){if(typeof window>"u"||!window.navigator)return;let t=this.getBrowserCultureLang();return t?t.split(/[-_]/)[0]:void 0}getBrowserCultureLang(){if(!(typeof window>"u"||typeof window.navigator>"u"))return window.navigator.languages?window.navigator.languages[0]:window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage}static \u0275fac=function(e){return new(e||i)(T(ne),T($),T(Q),T(W),T(ie),T(ke),T(ye),T(Ee),T(Me))};static \u0275prov=q({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var bt=(()=>{class i{translate;_ref;value="";lastKey=null;lastParams=[];onTranslationChange;onLangChange;onDefaultLangChange;constructor(t,e){this.translate=t,this._ref=e}updateValue(t,e,n){let l=m=>{this.value=m!==void 0?m:t,this.lastKey=t,this._ref.markForCheck()};if(n){let m=this.translate.getParsedResult(n,t,e);X(m)?m.subscribe(l):l(m)}this.translate.get(t,e).subscribe(l)}transform(t,...e){if(!t||!t.length)return t;if(Se(t,this.lastKey)&&Se(e,this.lastParams))return this.value;let n;if(z(e[0])&&e.length)if(Qe(e[0])&&e[0].length){let l=e[0].replace(/(')?([a-zA-Z0-9_]+)(')?(\s)?:/g,'"$2":').replace(/:(\s)?(')(.*?)(')/g,':"$3"');try{n=JSON.parse(l)}catch(m){throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${e[0]}`)}}else ue(e[0])&&(n=e[0]);return this.lastKey=t,this.lastParams=e,this.updateValue(t,n),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(l=>{this.lastKey&&l.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(t,n,l.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(l=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,n,l.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(t,n))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}static \u0275fac=function(e){return new(e||i)(h(Le,16),h(dt,16))};static \u0275pipe=at({name:"translate",type:i,pure:!1});static \u0275prov=q({token:i,factory:i.\u0275fac})}return i})();var Ei=(i={})=>ot([i.loader||{provide:$,useClass:Ge},i.compiler||{provide:Q,useClass:$e},i.parser||{provide:W,useClass:Ke},i.missingTranslationHandler||{provide:ie,useClass:ze},ne,{provide:ye,useValue:i.isolate},{provide:ke,useValue:i.useDefaultLang},{provide:Ee,useValue:i.extend},{provide:Me,useValue:i.defaultLanguage},Le]),_t=(()=>{class i{static forRoot(t={}){return{ngModule:i,providers:[t.loader||{provide:$,useClass:Ge},t.compiler||{provide:Q,useClass:$e},t.parser||{provide:W,useClass:Ke},t.missingTranslationHandler||{provide:ie,useClass:ze},ne,{provide:ye,useValue:t.isolate},{provide:ke,useValue:t.useDefaultLang},{provide:Ee,useValue:t.extend},{provide:Me,useValue:t.defaultLanguage},Le]}}static forChild(t={}){return{ngModule:i,providers:[t.loader||{provide:$,useClass:Ge},t.compiler||{provide:Q,useClass:$e},t.parser||{provide:W,useClass:Ke},t.missingTranslationHandler||{provide:ie,useClass:ze},{provide:ye,useValue:t.isolate},{provide:ke,useValue:t.useDefaultLang},{provide:Ee,useValue:t.extend},{provide:Me,useValue:t.defaultLanguage},Le]}}static \u0275fac=function(e){return new(e||i)};static \u0275mod=st({type:i});static \u0275inj=rt({})}return i})();function Lt(i,r){i&1&&(o(0,"p",21),a(1,"Obavezno"),s())}function Tt(i,r){i&1&&(o(0,"p",21),a(1,"Obavezno"),s())}function Pt(i,r){if(i&1&&(o(0,"div",22)(1,"button",23),a(2,"Prijavi se"),s()()),i&2){let t=p();c(),u("disabled",t.loginForm.invalid)}}function Ft(i,r){if(i&1){let t=_();o(0,"div",22)(1,"p",21),a(2,"Wrong Password"),s(),o(3,"button",24),d("accessibleClick",function(){f(t);let n=p();return g(n.openForgotPasswordModal())}),a(4," Zaboravili ste lozinku? "),s()()}}function It(i,r){if(i&1){let t=_();o(0,"div",22)(1,"button",24),d("accessibleClick",function(){f(t);let n=p();return g(n.resendVerification())}),a(2," Ponovno po\u0161alji verifikacijski link "),s()()}}function Dt(i,r){if(i&1&&(o(0,"p",25),a(1),s()),i&2){let t=p();c(),M(t.successMessage)}}function Vt(i,r){if(i&1&&(o(0,"p",21),a(1),s()),i&2){let t=p();c(),M(t.errorMessage)}}function Rt(i,r){if(i&1){let t=_();o(0,"div",22)(1,"span"),a(2,"Nemate ra\u010Dun?"),s(),o(3,"button",24),d("accessibleClick",function(){f(t);let n=p();return g(n.switchToRegister())}),a(4,"Register"),s()()}}function At(i,r){if(i&1){let t=_();o(0,"app-reset-password",26),d("close",function(){f(t);let n=p();return g(n.onCloseResetModal())}),s()}}var Te=class i{constructor(r,t,e,n){this.fb=r;this.authService=t;this.router=e;this.snackBar=n;this.loginForm=this.fb.group({identifier:["",C.required],password:["",C.required]})}closed=new w;loginForm;ngOnInit(){console.log("\u2705 LoginComponent inicijaliziran!")}submitted=!1;showPassword=!1;successMessage="";errorMessage="";showResend=!1;unverifiedUserId="";showRegisterSuggestion=!1;loginFailed=!1;hide=!0;showResetPasswordModal=!1;onLogin(){this.submitted=!0,!this.loginForm.invalid&&this.authService.login(this.loginForm.value).subscribe({next:r=>{console.log("Login response:",r),localStorage.setItem("token",r.token),this.snackBar.open("Successful login","",{duration:3e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"success-snackbar"}),this.loginFailed=!1,this.router.navigate(["/"]),this.authService.setAuthState(!0),this.authService.setUser(r.user),this.close()},error:r=>{r.status===403?(this.errorMessage=`Your account (${this.loginForm.value.identifier}) is not confirmed`,this.unverifiedUserId=r.error.userId,this.showResend=!0,this.snackBar.open(`Your account (${this.loginForm.value.identifier}) is not confirmed`,"",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"error-snackbar"})):r.status===401?(this.loginFailed=!0,this.showRegisterSuggestion=!0,this.snackBar.open("Incorrect password","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"error-snackbar"})):r.status===404?(this.errorMessage="The user does not exist",this.showRegisterSuggestion=!0,this.snackBar.open("The user does not exist","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"error-snackbar"})):(this.errorMessage="Incorrect data",this.showResend=!1,this.showRegisterSuggestion=!1)}})}get identifier(){return this.loginForm.get("identifier")}get password(){return this.loginForm.get("password")}close(){console.log("\u{1F525} zatvaram modal"),this.closed.emit()}loginWithGoogle(){window.location.href=`${K.apiUrl}/auth/google`}loginWithFacebook(){window.location.href=`${K.apiUrl}/auth/facebook`}togglePassword(){this.showPassword=!this.showPassword}get f(){return this.loginForm.controls}switchToRegister(){this.close(),window.dispatchEvent(new CustomEvent("switchToRegister"))}resendVerification(){let r=this.loginForm.value.identifier;if(!r){this.snackBar.open("Email not entered","",{duration:3e3});return}this.authService.resendVerificationEmail(r).subscribe({next:()=>{this.snackBar.open("Verification email sent","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"success-snackbar"}),this.showResend=!1,this.close()},error:()=>{this.snackBar.open(this.errorMessage,"",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"error-snackbar"})}})}onCloseResetModal(){this.showResetPasswordModal=!1}isSendingReset=!1;openForgotPasswordModal(){let r=this.loginForm.value.identifier;if(!r){this.snackBar.open("Enter your email to reset your password","",{duration:3e3});return}this.isSendingReset=!0,this.authService.sendResetPasswordEmail(r).subscribe({next:()=>{this.snackBar.open("Reset link sent to your email","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"success-snackbar"}),this.close()},error:()=>{this.snackBar.open("Error sending reset link","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"error-snackbar"})},complete:()=>{this.isSendingReset=!1}})}static \u0275fac=function(t){return new(t||i)(h(x),h(G),h(ee),h(j))};static \u0275cmp=S({type:i,selectors:[["app-login"]],outputs:{closed:"closed"},decls:36,vars:17,consts:[["appAccessibleClick","","aria-hidden","true",1,"bb-backdrop",3,"accessibleClick"],["appTrapFocus","","role","dialog","aria-modal","true","aria-labelledby","login-title",1,"bb-modal",3,"click","onEscape"],["appAccessibleClick","","aria-label","Close",1,"close-button",3,"accessibleClick"],[3,"ngSubmit","formGroup"],["id","login-title"],[1,"form-row"],["for","identifier"],["id","identifier","formControlName","identifier","placeholder","Username or Email"],["class","error",4,"ngIf"],["for","password"],[1,"password-wrapper"],["id","password","formControlName","password","placeholder","Password",1,"password-input",3,"type"],["type","button","appAccessibleClick","","aria-label","Toggle password visibility",1,"toggle-password",3,"accessibleClick"],[1,"bi",3,"ngClass"],["class","text-center",4,"ngIf"],[1,"oauth-inline"],[1,"muted"],["type","button",1,"link-button",3,"click"],[1,"sep"],["class","success",4,"ngIf"],[3,"close",4,"ngIf"],[1,"error"],[1,"text-center"],["type","submit",3,"disabled"],["type","button","appAccessibleClick","",1,"link-button",3,"accessibleClick"],[1,"success"],[3,"close"]],template:function(t,e){t&1&&(o(0,"div",0),d("accessibleClick",function(){return e.close()}),o(1,"div",1),d("click",function(l){return l.stopPropagation()}),o(2,"button",2),d("accessibleClick",function(){return e.close()}),a(3,"\xD7"),s(),o(4,"form",3),d("ngSubmit",function(){return e.onLogin()}),o(5,"h4",4),a(6,"Login"),s(),o(7,"div",5)(8,"label",6),a(9,"Email or Username:"),s(),b(10,"input",7),v(11,Lt,2,0,"p",8),s(),o(12,"div",5)(13,"label",9),a(14,"Password:"),s(),o(15,"div",10),b(16,"input",11),o(17,"button",12),d("accessibleClick",function(){return e.togglePassword()}),b(18,"i",13),s()(),v(19,Tt,2,0,"p",8),s(),v(20,Pt,3,1,"div",14),o(21,"div",15)(22,"span",16),a(23,"or continue with"),s(),o(24,"button",17),d("click",function(){return e.loginWithGoogle()}),a(25," Google "),s(),o(26,"span",18),a(27,"\xB7"),s(),o(28,"button",17),d("click",function(){return e.loginWithFacebook()}),a(29," Facebook "),s()(),v(30,Ft,5,0,"div",14)(31,It,3,0,"div",14)(32,Dt,2,1,"p",19)(33,Vt,2,1,"p",8)(34,Rt,5,0,"div",14)(35,At,1,0,"app-reset-password",20),s()()()),t&2&&(c(),u("onEscape",e.close),c(3),u("formGroup",e.loginForm),c(6),E("invalid",(e.identifier==null?null:e.identifier.invalid)&&((e.identifier==null?null:e.identifier.touched)||e.submitted)),c(),u("ngIf",(e.identifier==null?null:e.identifier.hasError("required"))&&((e.identifier==null?null:e.identifier.touched)||e.submitted)),c(5),E("invalid",(e.password==null?null:e.password.invalid)&&((e.password==null?null:e.password.touched)||e.submitted)),u("type",e.showPassword?"text":"password"),c(2),u("ngClass",e.showPassword?"bi-eye-slash":"bi-eye"),c(),u("ngIf",(e.password==null?null:e.password.hasError("required"))&&((e.password==null?null:e.password.touched)||e.submitted)),c(),u("ngIf",!e.showResend),c(10),u("ngIf",e.loginFailed),c(),u("ngIf",e.showResend),c(),u("ngIf",e.successMessage),c(),u("ngIf",e.errorMessage),c(),u("ngIf",!e.loginFailed&&e.showRegisterSuggestion),c(),u("ngIf",e.showResetPasswordModal))},dependencies:[k,_e,y,N,A,D,V,R,U,O,B,te,vt,F,P],encapsulation:2})};function Ut(i,r){i&1&&(o(0,"p",25),a(1," Obavezno "),s())}function Ot(i,r){i&1&&(o(0,"p",26),a(1," \xA0 "),s())}function xt(i,r){i&1&&(o(0,"p",25),a(1," Obavezno "),s())}function Nt(i,r){i&1&&(o(0,"p",25),a(1," Neispravan format emaila "),s())}function jt(i,r){i&1&&(o(0,"p",26),a(1," \xA0 "),s())}function Bt(i,r){i&1&&(o(0,"p",25),a(1," Obavezno "),s())}function Gt(i,r){i&1&&(o(0,"p",26),a(1," \xA0 "),s())}function zt(i,r){i&1&&(o(0,"p",25),a(1," Obavezno "),s())}function Ht(i,r){i&1&&(o(0,"p",25),a(1," Lozinke se ne podudaraju "),s())}function qt(i,r){i&1&&(o(0,"p",26),a(1," \xA0 "),s())}function Kt(i,r){if(i&1&&(o(0,"p",27),a(1),s()),i&2){let t=p();c(),M(t.successMessage)}}function $t(i,r){if(i&1&&(o(0,"p",25),a(1),s()),i&2){let t=p();c(),M(t.errorMessage)}}var Pe=class i{constructor(r,t,e){this.fb=r;this.http=t;this.snackBar=e;this.registerForm=this.fb.group({name:["",C.required],email:["",[C.required,C.email]],password:["",C.required],confirmPassword:["",C.required]},{validators:Wt})}closed=new w;registerForm;submitted=!1;successMessage="";errorMessage="";showPassword=!1;showConfirmPassword=!1;togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}register(){if(this.submitted=!0,this.registerForm.invalid)return;let{name:r,email:t,password:e}=this.registerForm.value;this.http.post(`${K.apiUrl}/auth/register`,{name:r,email:t,password:e}).subscribe({next:()=>{console.log("registracija"),this.snackBar.open("Registration successful! Check your email for verification","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:["success-snackbar"]}),this.successMessage="Registration successful. Please check your email to verify your account.",this.registerForm.reset(),this.submitted=!1,this.close()},error:n=>{this.errorMessage=n.error?.message||"Registration failed."}})}close(){this.closed.emit()}get name(){return this.registerForm.get("name")}get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}static \u0275fac=function(t){return new(t||i)(h(x),h(Y),h(j))};static \u0275cmp=S({type:i,selectors:[["app-register"]],outputs:{closed:"closed"},decls:50,vars:26,consts:[["appAccessibleClick","","aria-hidden","true",1,"bb-backdrop",3,"accessibleClick"],["appTrapFocus","","role","dialog","aria-modal","true","aria-labelledby","register-title",1,"bb-modal",3,"click","onEscape"],["appAccessibleClick","","aria-label","Close",1,"close-button",3,"accessibleClick"],[3,"ngSubmit","formGroup"],["id","register-title",1,"text-center"],[1,"form-row"],["for","name"],["type","text","id","name","formControlName","name","placeholder","Username",3,"keydown.space"],[1,"error-placeholder"],["class","error",4,"ngIf"],["class","error invisible",4,"ngIf"],["for","email"],["type","email","id","email","formControlName","email","placeholder","Email"],["for","password"],[1,"password-wrapper"],["id","password","formControlName","password","placeholder","Password",1,"password-input",3,"type"],["type","button","appAccessibleClick","",1,"toggle-password",3,"accessibleClick"],[1,"bi",3,"ngClass"],["for","confirmPassword"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Confirm Password",1,"password-input",3,"type"],[1,"fa","fa-eye"],[1,"text-center"],["type","submit",3,"disabled"],[1,"form-messages"],["class","success",4,"ngIf"],[1,"error"],[1,"error","invisible"],[1,"success"]],template:function(t,e){t&1&&(o(0,"div",0),d("accessibleClick",function(){return e.close()}),o(1,"div",1),d("click",function(l){return l.stopPropagation()}),o(2,"button",2),d("accessibleClick",function(){return e.close()}),a(3,"\xD7"),s(),o(4,"form",3),d("ngSubmit",function(){return e.register()}),o(5,"h4",4),a(6,"Register"),s(),b(7,"br"),o(8,"div",5)(9,"label",6),a(10,"Name:"),s(),o(11,"input",7),d("keydown.space",function(l){return l.stopPropagation()}),s(),o(12,"div",8),v(13,Ut,2,0,"p",9)(14,Ot,2,0,"p",10),s()(),o(15,"div",5)(16,"label",11),a(17,"Email:"),s(),b(18,"input",12),o(19,"div",8),v(20,xt,2,0,"p",9)(21,Nt,2,0,"p",9)(22,jt,2,0,"p",10),s()(),o(23,"div",5)(24,"label",13),a(25,"Password:"),s(),o(26,"div",14),b(27,"input",15),o(28,"button",16),d("accessibleClick",function(){return e.togglePasswordVisibility()}),b(29,"i",17),s()(),o(30,"div",8),v(31,Bt,2,0,"p",9)(32,Gt,2,0,"p",10),s()(),o(33,"div",5)(34,"label",18),a(35,"Confirm Password:"),s(),o(36,"div",14),b(37,"input",19),o(38,"button",16),d("accessibleClick",function(){return e.toggleConfirmPasswordVisibility()}),b(39,"i",20),s()(),o(40,"div",8),v(41,zt,2,0,"p",9)(42,Ht,2,0,"p",9)(43,qt,2,0,"p",10),s()(),o(44,"div",21)(45,"button",22),a(46,"Register"),s()(),o(47,"div",23),v(48,Kt,2,1,"p",24)(49,$t,2,1,"p",9),s()()()()),t&2&&(c(),u("onEscape",e.close),c(3),u("formGroup",e.registerForm),c(7),E("invalid",(e.name==null?null:e.name.invalid)&&((e.name==null?null:e.name.touched)||e.submitted)),c(2),u("ngIf",(e.name==null?null:e.name.hasError("required"))&&((e.name==null?null:e.name.touched)||e.submitted)),c(),u("ngIf",!(e.name!=null&&e.name.hasError("required"))||!(e.name!=null&&e.name.touched||e.submitted)),c(4),E("invalid",(e.email==null?null:e.email.invalid)&&((e.email==null?null:e.email.touched)||e.submitted)),c(2),u("ngIf",(e.email==null?null:e.email.hasError("required"))&&((e.email==null?null:e.email.touched)||e.submitted)),c(),u("ngIf",(e.email==null?null:e.email.hasError("email"))&&((e.email==null?null:e.email.touched)||e.submitted)),c(),u("ngIf",!(e.email!=null&&e.email.hasError("required"))&&!(e.email!=null&&e.email.hasError("email"))||!(e.email!=null&&e.email.touched||e.submitted)),c(5),E("invalid",(e.password==null?null:e.password.invalid)&&((e.password==null?null:e.password.touched)||e.submitted)),u("type",e.showPassword?"text":"password"),c(2),u("ngClass",e.showPassword?"bi-eye-slash":"bi-eye"),c(2),u("ngIf",(e.password==null?null:e.password.hasError("required"))&&((e.password==null?null:e.password.touched)||e.submitted)),c(),u("ngIf",!(e.password!=null&&e.password.hasError("required"))||!(e.password!=null&&e.password.touched||e.submitted)),c(5),E("invalid",(e.confirmPassword==null?null:e.confirmPassword.invalid)&&((e.confirmPassword==null?null:e.confirmPassword.touched)||e.submitted)),u("type",e.showConfirmPassword?"text":"password"),c(4),u("ngIf",(e.confirmPassword==null?null:e.confirmPassword.hasError("required"))&&((e.confirmPassword==null?null:e.confirmPassword.touched)||e.submitted)),c(),u("ngIf",(e.registerForm.errors==null?null:e.registerForm.errors.passwordsMismatch)&&((e.confirmPassword==null?null:e.confirmPassword.touched)||e.submitted)),c(),u("ngIf",!(e.confirmPassword!=null&&e.confirmPassword.hasError("required"))&&!(e.registerForm.errors!=null&&e.registerForm.errors.passwordsMismatch)||!(e.confirmPassword!=null&&e.confirmPassword.touched||e.submitted)),c(2),u("disabled",e.registerForm.invalid),c(3),u("ngIf",e.successMessage),c(),u("ngIf",e.errorMessage&&!(e.registerForm.errors!=null&&e.registerForm.errors.passwordsMismatch)))},dependencies:[k,_e,y,ft,A,D,V,R,N,U,O,B,F,P],encapsulation:2})},Wt=i=>{let r=i.get("password")?.value,t=i.get("confirmPassword")?.value;return r===t?null:{passwordsMismatch:!0}};function Qt(i,r){if(i&1){let t=_();lt(0),o(1,"button",10),d("click",function(){f(t);let n=p();return g(n.openLoginModal())}),a(2),he(3,"translate"),s(),o(4,"button",10),d("click",function(){f(t);let n=p();return g(n.openRegisterModal())}),a(5),he(6,"translate"),s(),ct()}i&2&&(c(2),M(ve(3,2,"login")),c(3),M(ve(6,4,"register")))}function Jt(i,r){if(i&1){let t=_();o(0,"div",11)(1,"span"),a(2),s(),o(3,"img",12),d("click",function(){f(t);let n=p();return g(n.openUserModal())}),s(),o(4,"button",10),d("click",function(){f(t);let n=p();return g(n.logout())}),a(5),he(6,"translate"),s()()}if(i&2){let t=p();c(2),ut("Welcome ",t.userDisplayName,""),c(),u("src",(t.user==null?null:t.user.avatarUrl)||"assets/images/defaultUser.png",fe),c(2),M(ve(6,3,"logout"))}}function Xt(i,r){if(i&1){let t=_();o(0,"app-register",13),d("closed",function(){f(t);let n=p();return g(n.closeRegisterModal())}),s()}}function Zt(i,r){if(i&1){let t=_();o(0,"app-login",13),d("closed",function(){f(t);let n=p();return g(n.closeLoginModal())}),s()}}var Fe=class i{constructor(r,t){this.authService=r;this.router=t}closed=new w;userModalOpened=new w;isLoggedIn=!1;authSub;showRegisterModal=!1;showLoginModal=!1;user=null;userNickname="";userDisplayName="";switchToRegisterHandler=()=>{this.showLoginModal=!1,this.showRegisterModal=!0};openLoginFromGlobal=()=>{this.showRegisterModal=!1,this.showLoginModal=!0};ngOnInit(){this.router.events.pipe(Z(r=>r instanceof Ce)).subscribe(r=>{r.url==="/login"&&this.openLoginModal(),r.url==="/register"&&this.openRegisterModal()}),this.authSub=this.authService.authStatus$.subscribe(r=>{this.isLoggedIn=r,this.user=r?this.authService.getUser():null,this.userNickname=this.user?.nickname||"",this.userDisplayName=this.user?.nickname||this.user?.name||"User"}),this.authService.user$.subscribe(r=>{this.user=r,this.userDisplayName=r?.nickname||r?.name||"User"}),window.addEventListener("switchToRegister",this.switchToRegisterHandler),window.addEventListener("openLogin",this.openLoginFromGlobal)}ngOnDestroy(){this.authSub&&this.authSub.unsubscribe(),window.removeEventListener("switchToRegister",this.switchToRegisterHandler),window.removeEventListener("openLogin",this.openLoginFromGlobal)}openLoginModal(){this.showRegisterModal=!1,this.showLoginModal=!0,document.body.classList.add("modal-open")}closeLoginModal(){this.showLoginModal=!1,this.showRegisterModal||document.body.classList.remove("modal-open")}openRegisterModal(){this.showLoginModal=!1,this.showRegisterModal=!0,document.body.classList.add("modal-open")}closeRegisterModal(){this.showRegisterModal=!1,this.showLoginModal||document.body.classList.remove("modal-open")}logout(){this.authService.logout()}openUserModal(){this.userModalOpened.emit()}static \u0275fac=function(t){return new(t||i)(h(G),h(ee))};static \u0275cmp=S({type:i,selectors:[["app-header"]],outputs:{closed:"closed",userModalOpened:"userModalOpened"},decls:18,vars:4,consts:[["loggedIn",""],["id","main-header",1,"custom-header","app-header"],[1,"navbar-nav"],["routerLink","/matches"],["routerLink","/players"],["routerLink","/tournaments"],[1,"brand-title"],[1,"main-title"],[4,"ngIf","ngIfElse"],[3,"closed",4,"ngIf"],[3,"click"],[1,"user-block",2,"display","flex","align-items","center","gap","8px"],["alt","Avatar",2,"width","32px","height","32px","border-radius","50%","cursor","pointer",3,"click","src"],[3,"closed"]],template:function(t,e){if(t&1&&(o(0,"nav",1)(1,"div")(2,"div",2)(3,"a",3),a(4,"Matches"),s(),o(5,"a",4),a(6,"Players"),s(),o(7,"a",5),a(8,"Tournaments"),s()(),o(9,"div",6)(10,"div",7),a(11,"Bonzo Byte"),s()(),o(12,"div",2),v(13,Qt,7,6,"ng-container",8)(14,Jt,7,5,"ng-template",null,0,be),s()()(),v(16,Xt,1,0,"app-register",9)(17,Zt,1,0,"app-login",9)),t&2){let n=ge(15);c(13),u("ngIf",!e.isLoggedIn)("ngIfElse",n),c(3),u("ngIf",e.showRegisterModal),c(),u("ngIf",e.showLoginModal)}},dependencies:[k,y,Pe,Te,te,pt,ht,_t,bt],styles:["[_nghost-%COMP%]{display:block}.custom-header[_ngcontent-%COMP%]{min-height:var(--header-h)}.custom-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:8px;padding:0 8px;min-height:var(--header-h);min-width:0}.custom-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;white-space:nowrap;min-width:0}.custom-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]:first-of-type{justify-self:start}.custom-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .brand-title[_ngcontent-%COMP%]{justify-self:center;text-align:center;white-space:nowrap}.custom-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .brand-title[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]{margin:0}.custom-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   .navbar-nav[_ngcontent-%COMP%]:last-of-type{justify-self:end}"]})};function Yt(i,r){i&1&&(o(0,"p",16),a(1,"Required"),s())}function ei(i,r){i&1&&(o(0,"p",16),a(1,"Required"),s())}function ti(i,r){i&1&&(o(0,"p",16),a(1,"Invalid email"),s())}function ii(i,r){i&1&&(o(0,"p",16),a(1,"Required"),s())}function ni(i,r){i&1&&(o(0,"p",16),a(1,"Minimum 10 characters"),s())}var Ie=class i{constructor(r,t,e){this.fb=r;this.snack=t;this.http=e;this.form=this.fb.group({name:["",C.required],email:["",[C.required,C.email]],message:["",[C.required,C.minLength(10)]]})}closed=new w;form;submitting=!1;ngOnInit(){document.body.classList.add("modal-open")}ngOnDestroy(){document.body.classList.remove("modal-open")}get name(){return this.form.get("name")}get email(){return this.form.get("email")}get message(){return this.form.get("message")}close(){document.body.classList.remove("modal-open"),this.closed.emit()}submit(){this.form.invalid||this.submitting||(this.submitting=!0,this.http.post(`${K.apiUrl}/auth/contact`,this.form.value).subscribe({next:()=>{this.snack.open("Message sent. Thanks!","",{duration:3e3,panelClass:"success-snackbar"}),this.form.reset(),this.close()},error:r=>{this.snack.open(r?.error?.message||"Failed to send message.","",{duration:4e3,panelClass:"error-snackbar"})},complete:()=>this.submitting=!1}))}static \u0275fac=function(t){return new(t||i)(h(x),h(j),h(Y))};static \u0275cmp=S({type:i,selectors:[["app-contact-modal"]],outputs:{closed:"closed"},decls:29,vars:14,consts:[["appAccessibleClick","","aria-hidden","true",1,"bb-backdrop",3,"accessibleClick"],["role","dialog","aria-modal","true","aria-labelledby","contact-title","appTrapFocus","",1,"bb-modal",3,"click","onEscape"],["appAccessibleClick","","aria-label","Close",1,"close-button",3,"accessibleClick"],["id","contact-title"],[3,"ngSubmit","formGroup"],[1,"form-row"],["for","c-name"],["id","c-name","type","text","formControlName","name"],["class","error",4,"ngIf"],["for","c-email"],["id","c-email","type","email","formControlName","email"],["for","c-msg"],["id","c-msg","rows","5","formControlName","message"],[1,"text-center",2,"margin-top","8px"],["type","submit",3,"disabled"],["type","button",1,"link-button",2,"margin-left","12px",3,"click"],[1,"error"]],template:function(t,e){t&1&&(o(0,"div",0),d("accessibleClick",function(){return e.close()}),o(1,"div",1),d("click",function(l){return l.stopPropagation()}),o(2,"button",2),d("accessibleClick",function(){return e.close()}),a(3,"\xD7"),s(),o(4,"h4",3),a(5,"Contact Us"),s(),o(6,"form",4),d("ngSubmit",function(){return e.submit()}),o(7,"div",5)(8,"label",6),a(9,"Name"),s(),b(10,"input",7),v(11,Yt,2,0,"p",8),s(),o(12,"div",5)(13,"label",9),a(14,"Email"),s(),b(15,"input",10),v(16,ei,2,0,"p",8)(17,ti,2,0,"p",8),s(),o(18,"div",5)(19,"label",11),a(20,"Message"),s(),b(21,"textarea",12),v(22,ii,2,0,"p",8)(23,ni,2,0,"p",8),s(),o(24,"div",13)(25,"button",14),a(26,"Send"),s(),o(27,"button",15),d("click",function(){return e.close()}),a(28,"Cancel"),s()()()()()),t&2&&(c(),u("onEscape",e.close),c(5),u("formGroup",e.form),c(4),E("invalid",(e.name==null?null:e.name.invalid)&&(e.name==null?null:e.name.touched)),c(),u("ngIf",(e.name==null?null:e.name.hasError("required"))&&(e.name==null?null:e.name.touched)),c(4),E("invalid",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),c(),u("ngIf",(e.email==null?null:e.email.hasError("required"))&&(e.email==null?null:e.email.touched)),c(),u("ngIf",(e.email==null?null:e.email.hasError("email"))&&(e.email==null?null:e.email.touched)),c(4),E("invalid",(e.message==null?null:e.message.invalid)&&(e.message==null?null:e.message.touched)),c(),u("ngIf",(e.message==null?null:e.message.hasError("required"))&&(e.message==null?null:e.message.touched)),c(),u("ngIf",(e.message==null?null:e.message.hasError("minlength"))&&(e.message==null?null:e.message.touched)),c(2),u("disabled",e.form.invalid||e.submitting))},dependencies:[k,y,N,A,D,V,R,U,O,B,P,F],encapsulation:2})};function ri(i,r){if(i&1){let t=_();o(0,"div",7),d("accessibleClick",function(){f(t);let n=p();return g(n.closeAbout())}),o(1,"div",8),d("click",function(n){return f(t),g(n.stopPropagation())}),o(2,"button",9),d("accessibleClick",function(){f(t);let n=p();return g(n.closeAbout())}),a(3,"\xD7"),s(),o(4,"h4",10),a(5,"About BonzoByte"),s(),o(6,"p"),a(7," Hobi-projekt: tenis + podaci + in\u017Eenjering. Vi\u0161e uskoro. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed non risus. Suspendisse lectus tortor, dignissim sit amet, adipiscing nec, ultricies sed, dolor. Cras elementum ultrices diam. Maecenas ligula massa, varius a, semper congue, euismod non, mi. "),s(),o(8,"div",11)(9,"button",12),d("click",function(){f(t);let n=p();return g(n.closeAbout())}),a(10,"Close"),s()()()()}if(i&2){let t=p();c(),u("onEscape",t.closeAbout)}}function oi(i,r){if(i&1){let t=_();o(0,"app-contact-modal",13),d("closed",function(){f(t);let n=p();return g(n.closeContact())}),s()}}var De=class i{showAbout=!1;showContact=!1;updateBodyLock(){let r=this.showAbout||this.showContact;document.body.classList.toggle("modal-open",r)}openAbout(){this.showContact=!1,this.showAbout=!0,this.updateBodyLock()}openContact(){this.showAbout=!1,this.showContact=!0,this.updateBodyLock()}closeAbout(){this.showAbout=!1,this.updateBodyLock()}closeContact(){this.showContact=!1,this.updateBodyLock()}ngOnDestroy(){document.body.classList.remove("modal-open")}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=S({type:i,selectors:[["app-footer"]],decls:12,vars:2,consts:[[1,"custom-footer"],[1,"footer-left"],["type","button",1,"footer-link",3,"click"],[1,"footer-center"],[1,"footer-right"],["class","bb-backdrop","appAccessibleClick","","aria-hidden","true",3,"accessibleClick",4,"ngIf"],[3,"closed",4,"ngIf"],["appAccessibleClick","","aria-hidden","true",1,"bb-backdrop",3,"accessibleClick"],["role","dialog","aria-modal","true","aria-labelledby","about-title","appTrapFocus","",1,"bb-modal",3,"click","onEscape"],["appAccessibleClick","","aria-label","Close",1,"close-button",3,"accessibleClick"],["id","about-title"],[1,"text-center",2,"margin-top","12px"],["type","button",3,"click"],[3,"closed"]],template:function(t,e){t&1&&(o(0,"footer",0)(1,"div",1)(2,"button",2),d("click",function(){return e.openAbout()}),a(3,"About Us"),s()(),o(4,"div",3)(5,"button",2),d("click",function(){return e.openContact()}),a(6,"Contact Us"),s()(),o(7,"div",4)(8,"span"),a(9,"\xA9 2025 BonzoByte"),s()()(),v(10,ri,11,1,"div",5)(11,oi,1,0,"app-contact-modal",6)),t&2&&(c(10),u("ngIf",e.showAbout),c(),u("ngIf",e.showContact))},dependencies:[k,y,Ie,F,P],styles:["[_nghost-%COMP%]{display:block}.custom-footer[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto 1fr;align-items:center;gap:8px;padding:0 8px;min-height:var(--footer-h);min-width:0}.footer-left[_ngcontent-%COMP%], .footer-center[_ngcontent-%COMP%], .footer-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;white-space:nowrap;min-width:0}.footer-left[_ngcontent-%COMP%]{justify-self:start}.footer-center[_ngcontent-%COMP%]{justify-self:center;text-align:center}.footer-right[_ngcontent-%COMP%]{justify-self:end}.footer-link[_ngcontent-%COMP%]{background:none;border:0;padding:0;margin:0;cursor:pointer}"]})};function si(i,r){i&1&&(o(0,"p",22),a(1," That username is already taken "),s())}function ai(i,r){if(i&1){let t=_();o(0,"button",23),d("accessibleClick",function(){f(t);let n=p();return g(n.changePassword())}),a(1," Change password "),s()}}function li(i,r){if(i&1&&(o(0,"p",24),a(1),s()),i&2){let t=p();c(),M(t.successMessage)}}function ci(i,r){if(i&1&&(o(0,"p",22),a(1),s()),i&2){let t=p();c(),M(t.errorMessage)}}function ui(i){return r=>{let t=(r.value||"").trim();return t?i.getUser()?.nickname&&t===i.getUser().nickname?L(null):L(t).pipe(it(300),ae(e=>i.checkNicknameExists(e)),se(e=>e?{nicknameTaken:!0}:null),et(()=>L(null))):L(null)}}var Ve=class i{constructor(r,t,e,n){this.fb=r;this.http=t;this.authService=e;this.snackBar=n}closed=new w;updated=new w;userForm;selectedFile=null;previewUrl=null;successMessage="";errorMessage="";submitted=!1;currentUser;isLocalAccount=!1;ngOnInit(){this.currentUser=this.authService.getUser(),this.isLocalAccount=this.currentUser?.createdVia?this.currentUser.createdVia==="manual":!this.currentUser?.googleId&&!this.currentUser?.facebookId,this.userForm=this.fb.group({email:[{value:this.currentUser.email||"",disabled:!0}],nickname:this.fb.control(this.currentUser.nickname||"",{validators:[C.minLength(3),C.maxLength(20)],asyncValidators:[ui(this.authService)],updateOn:"blur"})}),this.currentUser.avatarUrl&&(this.previewUrl=this.currentUser.avatarUrl),document.body.classList.add("modal-open")}ngOnDestroy(){document.body.classList.remove("modal-open")}close(){document.body.classList.remove("modal-open"),this.closed.emit()}isSaving=!1;onSubmit(){this.submitted=!0,this.successMessage="",this.errorMessage="";let r=this.userForm.get("nickname");if(r&&typeof r.value=="string"){let e=r.value,n=e.trim();n!==e&&r.setValue(n,{emitEvent:!1})}if(this.userForm.markAllAsTouched(),this.userForm.updateValueAndValidity({onlySelf:!1,emitEvent:!1}),this.userForm.pending){this.userForm.statusChanges.pipe(Z(e=>e!=="PENDING"),H(1)).subscribe(()=>this.onSubmit());return}if(this.userForm.invalid){this.errorMessage="Please fix validation errors before saving.";return}let t=new FormData;t.append("nickname",this.userForm.get("nickname")?.value||""),this.selectedFile&&t.append("avatar",this.selectedFile),this.isSaving=!0,this.authService.updateUser(t).pipe(nt(()=>this.isSaving=!1)).subscribe({next:e=>{this.currentUser=e,this.updated.emit(e),this.successMessage="Saved.",this.errorMessage="",this.userForm.markAsPristine()},error:e=>{let n=e?.error?.message||(e?.status===0?"Cannot reach API (network/CORS).":"")||"Update failed.";this.errorMessage=n}})}onFileSelected(r){let t=r.target;if(!t.files||t.files.length===0)return;let e=t.files[0],n=["image/jpeg","image/png","image/webp"];if(e.size>2*1024*1024){this.errorMessage="Datoteka je prevelika (max 2MB)",this.selectedFile=null,t.value="";return}if(!n.includes(e.type)){this.errorMessage="Dozvoljeni formati: JPG, PNG, WebP",this.selectedFile=null,t.value="";return}this.errorMessage="",this.selectedFile=e;let l=new FileReader;l.onload=()=>{this.previewUrl=l.result},l.readAsDataURL(e),this.userForm.markAsDirty()}changePassword(){let r=this.userForm.get("email")?.value;this.authService.sendResetPasswordEmail(r).subscribe({next:()=>{this.snackBar.open("Reset link poslan na va\u0161 email.","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"success-snackbar"})},error:()=>{this.snackBar.open("Gre\u0161ka prilikom slanja linka za reset.","",{duration:5e3,horizontalPosition:"right",verticalPosition:"bottom",panelClass:"error-snackbar"})}})}get nickname(){return this.userForm.get("nickname")}get email(){return this.userForm.get("email")}onAvatarError(r){r.target.src="assets/images/defaultUser.png"}static \u0275fac=function(t){return new(t||i)(h(x),h(Y),h(G),h(j))};static \u0275cmp=S({type:i,selectors:[["app-user-modal"]],outputs:{closed:"closed",updated:"updated"},decls:33,vars:8,consts:[["fileInput",""],["appAccessibleClick","","aria-hidden","true",1,"bb-backdrop",3,"accessibleClick"],["role","dialog","aria-modal","true","aria-labelledby","user-modal-title","appTrapFocus","",1,"bb-modal",3,"click","onEscape"],["appAccessibleClick","","aria-label","Close",1,"close-button",3,"accessibleClick"],["id","user-modal-title",1,"text-center"],["autocomplete","off",3,"ngSubmit","formGroup"],[1,"form-row"],["for","email"],["id","email","type","email","formControlName","email","readonly","","autocomplete","email"],["for","nickname"],["id","nickname","formControlName","nickname","autocomplete","username"],["class","error",4,"ngIf"],[1,"password-wrapper",2,"position","static"],[1,"avatar-container",2,"display","flex","align-items","center","gap","12px"],["alt","Avatar preview",1,"avatar-preview",2,"width","64px","height","64px","border-radius","50%","object-fit","cover",3,"error","src"],[1,"avatar-actions",2,"display","flex","gap","12px","align-items","center"],["type","button","appAccessibleClick","","title","Select a new image (max 2MB, JPG/PNG/WebP)",1,"link-button",3,"accessibleClick"],["type","file","hidden","","accept","image/jpeg,image/png,image/webp","aria-label","Select avatar image",3,"change"],["type","button","class","link-button","appAccessibleClick","",3,"accessibleClick",4,"ngIf"],[1,"text-center",2,"margin-top","8px"],["type","submit",3,"disabled"],["class","success",4,"ngIf"],[1,"error"],["type","button","appAccessibleClick","",1,"link-button",3,"accessibleClick"],[1,"success"]],template:function(t,e){if(t&1){let n=_();o(0,"div",1),d("accessibleClick",function(){return f(n),g(e.close())}),o(1,"div",2),d("click",function(m){return f(n),g(m.stopPropagation())}),o(2,"button",3),d("accessibleClick",function(){return f(n),g(e.close())}),a(3,"\xD7"),s(),o(4,"h4",4),a(5,"User data"),s(),o(6,"form",5),d("ngSubmit",function(){return f(n),g(e.onSubmit())}),o(7,"div",6)(8,"label",7),a(9,"Email"),s(),b(10,"input",8),s(),o(11,"div",6)(12,"label",9),a(13,"Username (nickname)"),s(),b(14,"input",10),v(15,si,2,0,"p",11),s(),o(16,"div",6)(17,"label"),a(18,"Avatar"),s(),o(19,"div",12)(20,"div",13)(21,"img",14),d("error",function(m){return f(n),g(e.onAvatarError(m))}),s(),o(22,"div",15)(23,"button",16),d("accessibleClick",function(){f(n);let m=ge(26);return g(m.click())}),a(24," Change avatar "),s(),o(25,"input",17,0),d("change",function(m){return f(n),g(e.onFileSelected(m))}),s(),v(27,ai,2,0,"button",18),s()()()(),o(28,"div",19)(29,"button",20),a(30,"Save"),s()(),v(31,li,2,1,"p",21)(32,ci,2,1,"p",11),s()()()}t&2&&(c(),u("onEscape",e.close),c(5),u("formGroup",e.userForm),c(9),u("ngIf",e.userForm.controls.nickname==null||e.userForm.controls.nickname.errors==null?null:e.userForm.controls.nickname.errors.nicknameTaken),c(6),u("src",e.previewUrl||e.currentUser.avatarUrl||"assets/images/defaultUser.png",fe),c(6),u("ngIf",e.isLocalAccount),c(2),u("disabled",e.userForm.invalid||e.userForm.pristine||e.userForm.pending),c(2),u("ngIf",e.successMessage),c(),u("ngIf",e.errorMessage))},dependencies:[k,y,N,A,D,V,R,U,O,B,F,P],encapsulation:2})};var di=["aboutUsModal"],mi=["contactUsModal"];function pi(i,r){if(i&1){let t=_();o(0,"app-user-modal",5),d("closed",function(){f(t);let n=p();return g(n.showUserModal=!1)})("updated",function(n){f(t);let l=p();return g(l.onUserUpdated(n))}),s()}}function fi(i,r){i&1&&(o(0,"div",6)(1,"h5",7),a(2,"About Us"),s()(),o(3,"div",8)(4,"p"),a(5," BonzoByte je hobi-projekt stvoren iz ljubavi prema tenisu, tehnologiji i \u2013 da, psima \u{1F436}. Ovdje \u0107emo graditi, u\u010Diti i zabavljati se. Hvala \u0161to ste tu! "),s(),b(6,"hr"),o(7,"p",9),a(8," \u201CNeque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit\u2026\u201D "),s()())}var St=class i{constructor(r,t,e){this.authService=r;this.router=t;this.modalService=e}aboutUsModal;contactUsModal;showUserModal=!1;showMatchFilterModal=!1;user=null;routerSub;ngOnInit(){try{let r=new URL(window.location.href),t=r.searchParams.get("token");if(t){localStorage.setItem("token",t),this.authService.initAuth(!0),r.searchParams.delete("token");let e=r.pathname+(r.searchParams.toString()?`?${r.searchParams.toString()}`:"");history.replaceState({},"",e)}else this.authService.initAuth()}catch{this.authService.initAuth()}this.routerSub=this.router.events.pipe(Z(r=>r instanceof Ce)).subscribe(r=>{typeof gtag=="function"&&gtag("config","G-Z7VMGXTFFP",{page_path:r.urlAfterRedirects})})}ngOnDestroy(){this.routerSub?.unsubscribe()}onOpenUserModal(){this.showUserModal=!0}onUserUpdated(r){this.authService.setUser(r),this.user=r,this.showUserModal=!1}openMatchFilterModal(){this.showMatchFilterModal=!0}closeMatchFilterModal(){this.showMatchFilterModal=!1}openAboutModal(){this.aboutUsModal&&this.modalService.open(this.aboutUsModal,{centered:!0})}openContactModal(){this.contactUsModal&&this.modalService.open(this.contactUsModal,{centered:!0})}static \u0275fac=function(t){return new(t||i)(h(G),h(ee),h(gt))};static \u0275cmp=S({type:i,selectors:[["app-root"]],viewQuery:function(t,e){if(t&1&&(Ne(di,5),Ne(mi,5)),t&2){let n;je(n=Be())&&(e.aboutUsModal=n.first),je(n=Be())&&(e.contactUsModal=n.first)}},decls:7,vars:1,consts:[["aboutUsModal",""],[3,"userModalOpened"],[3,"closed","updated",4,"ngIf"],[1,"main-content"],[1,"app-footer"],[3,"closed","updated"],[1,"modal-header","justify-content-center"],[1,"modal-title","text-center","w-100"],[1,"modal-body"],[1,"fst-italic","text-muted","text-end",2,"font-size","0.9rem","z-index","1200!important"]],template:function(t,e){if(t&1){let n=_();o(0,"app-header",1),d("userModalOpened",function(){return f(n),g(e.onOpenUserModal())}),s(),v(1,pi,1,0,"app-user-modal",2)(2,fi,9,0,"ng-template",null,0,be),o(4,"main",3),b(5,"router-outlet"),s(),b(6,"app-footer",4)}t&2&&(c(),u("ngIf",e.showUserModal))},dependencies:[k,y,te,mt,Fe,De,Ve],encapsulation:2})};export{$ as a,Le as b,Ei as c,St as d};
