import{a as j}from"./chunk-GTH4H3DD.js";import{k as C}from"./chunk-UL5CEDMN.js";import{a as R,b as $}from"./chunk-4PILAPRA.js";import{a as H,f as L}from"./chunk-3TN6O5IR.js";import{Db as a,Eb as y,Fb as h,Kb as A,Ma as s,Mb as O,Ra as D,Xa as v,_ as E,ab as u,da as w,fc as b,gc as V,hb as c,hc as B,jc as x,ka as f,la as g,lb as N,nb as n,ob as r,pb as _,ra as T,sb as P,tb as p,ub as d}from"./chunk-7QM3SHZA.js";function q(l,i){if(l&1){let e=P();n(0,"div",10)(1,"input",11),p("change",function(){let o=f(e).$implicit,m=d();return g(m.toggleTournamentType(o._id))}),r(),n(2,"label",12),a(3),r()()}if(l&2){let e=i.$implicit,t=d();s(),c("id","tournamentType-"+e._id)("checked",t.selectedTournamentTypeIds.includes(e._id)),s(),c("for","tournamentType-"+e._id),s(),h(" ",e.type," ")}}var I=class l{activeTournamentTypeIds=[];filterApplied=new T;resetFilter=new T;closed=new T;tournamentTypes=[{_id:2,type:"ATP"},{_id:4,type:"WTA"}];selectedTournamentTypeIds=[];ngOnInit(){this.selectedTournamentTypeIds=[...this.activeTournamentTypeIds],this.selectedTournamentTypeIds.length===0&&(this.selectedTournamentTypeIds=[2,4])}toggleTournamentType(i){let e=this.selectedTournamentTypeIds.indexOf(i);e>-1?this.selectedTournamentTypeIds.splice(e,1):this.selectedTournamentTypeIds.push(i)}apply(){this.filterApplied.emit([...this.selectedTournamentTypeIds]),this.closed.emit()}reset(){this.selectedTournamentTypeIds=[2,4],this.resetFilter.emit(),this.closed.emit()}close(){this.closed.emit()}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=v({type:l,selectors:[["app-player-filter-modal"]],inputs:{activeTournamentTypeIds:"activeTournamentTypeIds"},outputs:{filterApplied:"filterApplied",resetFilter:"resetFilter",closed:"closed"},decls:18,vars:2,consts:[["appAccessibleClick","",1,"modal-backdrop",3,"accessibleClick"],["appTrapFocus","",1,"modal-content",3,"click","onEscape"],["appAccessibleClick","",1,"close-button",3,"accessibleClick"],[1,"text-center"],[1,"modal-body"],[1,"text-start","mt-3"],["for","tournamentTypeFilter",1,"form-label","fw-bold","mb-1"],["class","form-check d-flex align-items-center gap-2 ms-3",4,"ngFor","ngForOf"],[1,"text-center","mt-3","d-flex","justify-content-center","gap-4"],[1,"link-button",3,"click"],[1,"form-check","d-flex","align-items-center","gap-2","ms-3"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label","mb-0",3,"for"]],template:function(e,t){e&1&&(n(0,"div",0),p("accessibleClick",function(){return t.close()}),n(1,"div",1),p("click",function(m){return m.stopPropagation()}),n(2,"button",2),p("accessibleClick",function(){return t.close()}),a(3,"\xD7"),r(),n(4,"h5",3),a(5,"Filter Players"),r(),_(6,"br"),n(7,"div",4)(8,"div",5)(9,"label",6),a(10,"Filter by Tournament Type:"),r(),n(11,"div",5),u(12,q,4,4,"div",7),r()()(),n(13,"div",8)(14,"button",9),p("click",function(){return t.apply()}),a(15,"Apply"),r(),n(16,"button",9),p("click",function(){return t.reset()}),a(17,"Reset"),r()()()()),e&2&&(s(),c("onEscape",t.close),s(11),c("ngForOf",t.tournamentTypes))},dependencies:[x,b,C,R,$],encapsulation:2})};var S=class l{playerTPId;closed=new T;close(){this.closed.emit()}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=v({type:l,selectors:[["app-player-modal"]],inputs:{playerTPId:"playerTPId"},outputs:{closed:"closed"},decls:9,vars:0,consts:[[1,"modal-backdrop","show"],[1,"modal","show"],[1,"modal-header","justify-content-between","align-items-center"],[1,"modal-title"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"modal-body"]],template:function(e,t){e&1&&(_(0,"div",0),n(1,"div",1)(2,"div",2)(3,"h5",3),a(4,"Coming soon"),r(),n(5,"button",4),p("click",function(){return t.closed.emit()}),a(6,"\xD7"),r()(),n(7,"div",5),a(8," Placeholder modal content. "),r()())},dependencies:[x],encapsulation:2})};var k=class l{constructor(i){this.http=i}apiUrl=`${L.apiUrl}/players`;getPaginatedPlayers(i,e,t,o,m=[]){let M={page:i.toString(),pageSize:e.toString(),sortField:t,sortDirection:o};return m.length>0&&m.length<2&&(M.tournamentTypeIds=m.join(",")),this.http.get(`${this.apiUrl}/paginated`,{params:M})}static \u0275fac=function(e){return new(e||l)(w(H))};static \u0275prov=E({token:l,factory:l.\u0275fac,providedIn:"root"})};function J(l,i){l&1&&(n(0,"span",18),a(1,"\u25CF"),r())}function K(l,i){if(l&1&&(n(0,"span"),a(1),r()),l&2){let e=d();s(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function Q(l,i){if(l&1&&(n(0,"span"),a(1),r()),l&2){let e=d();s(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function X(l,i){if(l&1&&(n(0,"span"),a(1),r()),l&2){let e=d();s(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function Y(l,i){if(l&1&&(n(0,"span"),a(1),r()),l&2){let e=d();s(),y(e.sortDirection==="asc"?"\u2191":"\u2193")}}function Z(l,i){if(l&1){let e=P();n(0,"tr")(1,"td"),_(2,"span"),n(3,"span",19),p("click",function(){let o=f(e).$implicit,m=d();return g(m.openPlayerModal(o.playerTPId))}),a(4),r()(),n(5,"td"),a(6),A(7,"date"),r(),n(8,"td"),a(9),r(),n(10,"td"),a(11),r(),n(12,"td"),a(13),r(),n(14,"td"),a(15),r(),n(16,"td"),a(17),r(),n(18,"td"),a(19),r()()}if(l&2){let e=i.$implicit,t=d();s(2),N("fi fi-",e.countryTPId==null||e.countryTPId.countryISO2==null?null:e.countryTPId.countryISO2.toLowerCase(),""),s(2),h(" ",t.decodeHtmlEntities(e.playerName)," "),s(2),h(" ",e.playerBirthDate?O(7,11,e.playerBirthDate,"yyyy-MM-dd"):""," "),s(3),y(e.playerHeight!==void 0&&e.playerHeight>0?e.playerHeight:""),s(2),y(e.playerWeight!==void 0&&e.playerWeight>0?e.playerWeight:""),s(2),h("",e.playerTurnedPro!==void 0&&e.playerTurnedPro>0?e.playerTurnedPro:""," "),s(2),y((e.playsId==null?null:e.playsId.plays)||""),s(2),y(e.trueSkillMean),s(2),y(e.careerTrueSkillMean)}}function ee(l,i){if(l&1){let e=P();n(0,"app-player-modal",20),p("closed",function(){f(e);let o=d();return g(o.closePlayerModal())}),r()}if(l&2){let e=d();c("playerTPId",e.selectedPlayer)}}function te(l,i){if(l&1){let e=P();n(0,"app-player-filter-modal",21),p("closed",function(){f(e);let o=d();return g(o.closeFilterModal())})("filterApplied",function(o){f(e);let m=d();return g(m.onFilterApplied(o))})("resetFilter",function(){f(e);let o=d();return g(o.resetFilter())}),r()}if(l&2){let e=d();c("activeTournamentTypeIds",e.activeTournamentTypeIds)}}var z=class l{constructor(i){this.playerService=i}players=[];currentPage=1;pageSize=100;totalPages=0;selectedPlayer=null;sortField="playerName";sortDirection="asc";isFiltered=!1;showFilterModal=!1;activeTournamentTypeIds=[2,4];ngOnInit(){this.loadPlayers()}loadPlayers(){this.playerService.getPaginatedPlayers(this.currentPage,this.pageSize,this.sortField,this.sortDirection,this.activeTournamentTypeIds).subscribe(i=>{this.players=i.players,this.totalPages=i.pagination.totalPages})}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadPlayers(),this.scrollToTop())}previousPage(){this.currentPage>1&&(this.currentPage--,this.loadPlayers(),this.scrollToTop())}openPlayerModal(i){this.selectedPlayer=i,console.log(i)}closePlayerModal(){this.selectedPlayer=null}openFilterModal(){this.showFilterModal=!0}closeFilterModal(){this.showFilterModal=!1}onPageInputChange(i){let e=i.target,t=Number(e.value);!isNaN(t)&&t>=1&&t<=this.totalPages&&(this.currentPage=t,this.loadPlayers(),this.scrollToTop())}scrollToTop(){let i=document.querySelector(".player-table-wrapper");i&&(i.scrollTop=0)}decodeHtmlEntities(i){let e=document.createElement("textarea");return e.innerHTML=i,e.value}sortPlayers(){this.players.sort((i,e)=>{let t="",o="";switch(this.sortField){case"playerName":t=i.playerName?.toLowerCase()||"",o=e.playerName?.toLowerCase()||"";break;case"playerBirthDate":t=i.playerBirthDate?new Date(i.playerBirthDate).getTime():0,o=e.playerBirthDate?new Date(e.playerBirthDate).getTime():0;break;case"trueSkillMean":t=i.trueSkillMean??0,o=e.trueSkillMean??0;break;case"careerTrueSkillMean":t=i.careerTrueSkillMean??0,o=e.careerTrueSkillMean??0;break}let m=t<o?-1:t>o?1:0;return this.sortDirection==="asc"?m:-m})}toggleSort(i){this.sortField===i?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=i,this.sortDirection="asc"),this.loadPlayers()}onFilterApplied(i){this.activeTournamentTypeIds=i,this.isFiltered=i.length!==2,this.currentPage=1,this.loadPlayers(),this.closeFilterModal()}resetFilter(){this.activeTournamentTypeIds=[2,4],this.isFiltered=!1,this.currentPage=1,this.loadPlayers(),this.closeFilterModal()}static \u0275fac=function(e){return new(e||l)(D(k))};static \u0275cmp=v({type:l,selectors:[["app-players"]],decls:43,vars:13,consts:[[1,"players-page-wrapper"],[1,"date-nav-sticky","d-flex","align-items-center","justify-content-between","mt-3","px-2"],[1,"pagination-center-wrapper","mx-auto","d-flex","align-items-center","gap-3"],[1,"link-button",3,"click","disabled"],["src","assets/icons/left.svg","alt","Previous",1,"arrow-icon"],["type","number","min","1",1,"custom-page-input","no-spin",3,"change","value","max"],["src","assets/icons/right.svg","alt","Next",1,"arrow-icon"],[1,"filter-button-wrapper"],[1,"link-button","d-flex","align-items-center","gap-2",3,"click"],["src","assets/icons/filter.svg","alt","Filter",1,"arrow-icon"],["class","badge bg-success ms-1",4,"ngIf"],[1,"player-table-wrapper"],[1,"player-table"],[3,"click"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"playerTPId","closed",4,"ngIf"],[3,"activeTournamentTypeIds","closed","filterApplied","resetFilter",4,"ngIf"],[1,"badge","bg-success","ms-1"],[1,"clickable-text",3,"click"],[3,"closed","playerTPId"],[3,"closed","filterApplied","resetFilter","activeTournamentTypeIds"]],template:function(e,t){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),p("click",function(){return t.previousPage()}),_(4,"img",4),r(),n(5,"input",5),p("change",function(m){return t.onPageInputChange(m)}),r(),n(6,"span"),a(7),r(),n(8,"button",3),p("click",function(){return t.nextPage()}),_(9,"img",6),r()(),n(10,"div",7)(11,"button",8),p("click",function(){return t.openFilterModal()}),_(12,"img",9),a(13," Filter "),u(14,J,2,0,"span",10),r()()(),n(15,"div",11)(16,"table",12)(17,"thead")(18,"tr")(19,"th",13),p("click",function(){return t.toggleSort("playerName")}),a(20," Name "),u(21,K,2,1,"span",14),r(),n(22,"th",13),p("click",function(){return t.toggleSort("playerBirthDate")}),a(23," Birth Date "),u(24,Q,2,1,"span",14),r(),n(25,"th"),a(26,"Height (cm)"),r(),n(27,"th"),a(28,"Weight (kg)"),r(),n(29,"th"),a(30,"Turned Pro"),r(),n(31,"th"),a(32,"Plays"),r(),n(33,"th",13),p("click",function(){return t.toggleSort("trueSkillMean")}),a(34," TS Mean "),u(35,X,2,1,"span",14),r(),n(36,"th",13),p("click",function(){return t.toggleSort("careerTrueSkillMean")}),a(37," TS Mean Career "),u(38,Y,2,1,"span",14),r()()(),n(39,"tbody"),u(40,Z,20,14,"tr",15),r()()(),u(41,ee,1,1,"app-player-modal",16)(42,te,1,1,"app-player-filter-modal",17),r()),e&2&&(s(3),c("disabled",t.currentPage===1),s(2),c("value",t.currentPage)("max",t.totalPages),s(2),h("of ",t.totalPages,""),s(),c("disabled",t.currentPage===t.totalPages),s(6),c("ngIf",t.isFiltered),s(7),c("ngIf",t.sortField==="playerName"),s(3),c("ngIf",t.sortField==="playerBirthDate"),s(11),c("ngIf",t.sortField==="trueSkillMean"),s(3),c("ngIf",t.sortField==="careerTrueSkillMean"),s(2),c("ngForOf",t.players),s(),c("ngIf",t.selectedPlayer),s(),c("ngIf",t.showFilterModal))},dependencies:[x,b,V,B,C,j,S,I],encapsulation:2})};export{z as PlayersComponent};
